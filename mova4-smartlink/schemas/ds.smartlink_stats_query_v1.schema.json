{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mova.dev/schemas/ds.smartlink_stats_query_v1.schema.json",
  "title": "SmartLink Statistics Query v1",
  "description": "Query parameters for retrieving SmartLink statistics. Part of SmartLink MOVA 4.0.0 implementation.",
  "type": "object",
  "properties": {
    "smartlink_id": {
      "type": "string",
      "description": "The smartlink identifier to query stats for. If omitted, returns aggregated stats for all smartlinks."
    },
    "time_range": {
      "type": "object",
      "description": "Time range for the statistics query.",
      "properties": {
        "from": {
          "type": "string",
          "format": "date-time",
          "description": "Start of time range (ISO 8601)."
        },
        "to": {
          "type": "string",
          "format": "date-time",
          "description": "End of time range (ISO 8601)."
        }
      },
      "required": [
        "from",
        "to"
      ],
      "additionalProperties": false
    },
    "group_by": {
      "type": "array",
      "description": "Dimensions to group statistics by.",
      "items": {
        "type": "string",
        "enum": [
          "target_id",
          "country",
          "device",
          "utm_source",
          "utm_campaign",
          "outcome",
          "hour",
          "day"
        ]
      },
      "uniqueItems": true
    },
    "filters": {
      "type": "object",
      "description": "Optional filters to narrow down results.",
      "properties": {
        "target_id": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "country": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "device": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "outcome": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "limit": {
      "type": "integer",
      "minimum": 1,
      "maximum": 10000,
      "description": "Maximum number of result rows to return."
    },
    "offset": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of rows to skip (for pagination)."
    }
  },
  "additionalProperties": false
}
